function debounce(e,t,i){var r;return function(){var n=this,s=arguments,o=function(){r=null,i||e.apply(n,s)},a=i&&!r;clearTimeout(r),r=setTimeout(o,t),a&&e.apply(n,s)}}function getClassnameForCode(e){return e<0||e>47?"wi-na":codeToClassname[e]}var app={debug:!0,modules:{widgets:{},templates:{}},bapiModules:{widgets:{},templates:{}},init:function(){this.initModules(this.modules),this.fixedHeader(),this.kdMove()},initBapi:function(){this.initModules(this.bapiModules)},initModules:function(e){for(var t in e)"function"==typeof e[t].init&&"function"==typeof e[t].cond?e[t].cond()&&(app.log("Initializing module",t,e[t]),e[t].init()):this.initModules(e[t])},initSwiper:function(e,t){return new Swiper(e,t)},fixedHeader:function(){function e(){var e=window.scrollY;e>=r?t.classList.add("fixed"):t.classList.remove("fixed")}var t=(document.querySelector("body"),document.querySelector(".header-background")),i=document.querySelector(".header-background .under_header"),r=t.clientHeight-i.clientHeight;window.addEventListener("scroll",e),e()},exists:function(e){var t=document.querySelector(e);return!!t},isMobile:function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)},log:function(){this.debug&&console.log.apply(console,arguments)},bapiRender:function(e,t,i,r){var n={pagesize:20,seo:!0};BAPI.search(e,n,function(n){BAPI.get(n.result,e,{},function(e){var n={};n.result=e.result,n.config=BAPI.config();var s="object"==typeof r?Object.assign(n,r):n,o=Mustache.render(BAPI.UI.mustacheHelpers.getPartials(t),s);i(o)})})},bapi:{search:function(e,t,i){var r=i||{};BAPI.search(e,r,function(e){t(e)})},get:function(e,t,i,r){BAPI.get(t,e,_.assign(r,{}),function(e){i(e)})},recursiveGet:function(e,t,i){var r=i||{pagesize:20,waitForAll:!1};BAPI.search(e,r,function(i){var n=_.chunk(i.result,r.pagesize);if(1==r.waitForAll){var s=[],o=0;n.forEach(function(i,a){BAPI.get(i,e,r,function(e){o++,s=_.concat(s,e.result),o==n.length&&t({result:s,textdata:BAPI.textdata})})})}else n.forEach(function(i,n){BAPI.get(i,e,r,function(e){t(e)})})})},render:function(e,t){return Mustache.render(BAPI.UI.mustacheHelpers.getPartials(e),t)}},kdMove:function(){for(var e=document.querySelectorAll("[data-move]"),t=0;t<e.length;t++){var i=e[t],r=document.querySelector(i.dataset.move);r.appendChild(e[t]),i.classList.add("hasMoved")}}};window.addEventListener("load",app.init.bind(app)),window.addEventListener("DOMContentLoaded",app.initBapi.bind(app)),function(e){function t(e){y.push(e),b||(b=!0,g(r))}function i(e){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(e)||e}function r(){b=!1;var e=y;y=[],e.sort(function(e,t){return e.uid_-t.uid_});var t=!1;e.forEach(function(e){var i=e.takeRecords();n(e),i.length&&(e.callback_(i,e),t=!0)}),t&&r()}function n(e){e.nodes_.forEach(function(t){var i=m.get(t);i&&i.forEach(function(t){t.observer===e&&t.removeTransientObservers()})})}function s(e,t){for(var i=e;i;i=i.parentNode){var r=m.get(i);if(r)for(var n=0;n<r.length;n++){var s=r[n],o=s.options;if(i===e||o.subtree){var a=t(o);a&&s.enqueue(a)}}}}function o(e){this.callback_=e,this.nodes_=[],this.records_=[],this.uid_=++k}function a(e,t){this.type=e,this.target=t,this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null}function c(e){var t=new a(e.type,e.target);return t.addedNodes=e.addedNodes.slice(),t.removedNodes=e.removedNodes.slice(),t.previousSibling=e.previousSibling,t.nextSibling=e.nextSibling,t.attributeName=e.attributeName,t.attributeNamespace=e.attributeNamespace,t.oldValue=e.oldValue,t}function l(e,t){return S=new a(e,t)}function u(e){return M?M:(M=c(S),M.oldValue=e,M)}function d(){S=M=void 0}function p(e){return e===M||e===S}function h(e,t){return e===t?e:M&&p(e)?M:null}function f(e,t,i){this.observer=e,this.target=t,this.options=i,this.transientObservedNodes=[]}if(!e.JsMutationObserver){var g,m=new WeakMap;if(/Trident|Edge/.test(navigator.userAgent))g=setTimeout;else if(window.setImmediate)g=window.setImmediate;else{var v=[],w=String(Math.random());window.addEventListener("message",function(e){if(e.data===w){var t=v;v=[],t.forEach(function(e){e()})}}),g=function(e){v.push(e),window.postMessage(w,"*")}}var b=!1,y=[],k=0;o.prototype={observe:function(e,t){if(e=i(e),!t.childList&&!t.attributes&&!t.characterData||t.attributeOldValue&&!t.attributes||t.attributeFilter&&t.attributeFilter.length&&!t.attributes||t.characterDataOldValue&&!t.characterData)throw new SyntaxError;var r=m.get(e);r||m.set(e,r=[]);for(var n,s=0;s<r.length;s++)if(r[s].observer===this){n=r[s],n.removeListeners(),n.options=t;break}n||(n=new f(this,e,t),r.push(n),this.nodes_.push(e)),n.addListeners()},disconnect:function(){this.nodes_.forEach(function(e){for(var t=m.get(e),i=0;i<t.length;i++){var r=t[i];if(r.observer===this){r.removeListeners(),t.splice(i,1);break}}},this),this.records_=[]},takeRecords:function(){var e=this.records_;return this.records_=[],e}};var S,M;f.prototype={enqueue:function(e){var i=this.observer.records_,r=i.length;if(i.length>0){var n=i[r-1],s=h(n,e);if(s)return void(i[r-1]=s)}else t(this.observer);i[r]=e},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(e){var t=this.options;t.attributes&&e.addEventListener("DOMAttrModified",this,!0),t.characterData&&e.addEventListener("DOMCharacterDataModified",this,!0),t.childList&&e.addEventListener("DOMNodeInserted",this,!0),(t.childList||t.subtree)&&e.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(e){var t=this.options;t.attributes&&e.removeEventListener("DOMAttrModified",this,!0),t.characterData&&e.removeEventListener("DOMCharacterDataModified",this,!0),t.childList&&e.removeEventListener("DOMNodeInserted",this,!0),(t.childList||t.subtree)&&e.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(e){if(e!==this.target){this.addListeners_(e),this.transientObservedNodes.push(e);var t=m.get(e);t||m.set(e,t=[]),t.push(this)}},removeTransientObservers:function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach(function(e){this.removeListeners_(e);for(var t=m.get(e),i=0;i<t.length;i++)if(t[i]===this){t.splice(i,1);break}},this)},handleEvent:function(e){switch(e.stopImmediatePropagation(),e.type){case"DOMAttrModified":var t=e.attrName,i=e.relatedNode.namespaceURI,r=e.target,n=new l("attributes",r);n.attributeName=t,n.attributeNamespace=i;var o=e.attrChange===MutationEvent.ADDITION?null:e.prevValue;s(r,function(e){if(e.attributes&&(!e.attributeFilter||!e.attributeFilter.length||e.attributeFilter.indexOf(t)!==-1||e.attributeFilter.indexOf(i)!==-1))return e.attributeOldValue?u(o):n});break;case"DOMCharacterDataModified":var r=e.target,n=l("characterData",r),o=e.prevValue;s(r,function(e){if(e.characterData)return e.characterDataOldValue?u(o):n});break;case"DOMNodeRemoved":this.addTransientObserver(e.target);case"DOMNodeInserted":var a,c,p=e.target;"DOMNodeInserted"===e.type?(a=[p],c=[]):(a=[],c=[p]);var h=p.previousSibling,f=p.nextSibling,n=l("childList",e.target.parentNode);n.addedNodes=a,n.removedNodes=c,n.previousSibling=h,n.nextSibling=f,s(e.relatedNode,function(e){if(e.childList)return n})}d()}},e.JsMutationObserver=o,e.MutationObserver||(e.MutationObserver=o,o._isPolyfilled=!0)}}(self),void function(e,t,i){function r(e,t,i){return"function"==typeof t&&(i=t,t=n(i).replace(/_$/,"")),a(e,t,{configurable:!0,writable:!0,value:i})}function n(e){return"function"!=typeof e?"":"name"in e?e.name:c.call(e).match(d)[1]}function s(e){function t(t,n){return n||2===arguments.length?r.set(t,n):(n=r.get(t),n===i&&(n=e(t),r.set(t,n))),n}var r=new WeakMap;return e||(e=f),t}var o=Object.getOwnPropertyNames,a=Object.defineProperty,c=Function.prototype.toString,l=Object.create,u=Object.prototype.hasOwnProperty,d=/^\n?function\s?(\w*)?_?\(/,p=function(){function e(){var e=c(),i={};this.unlock=function(r){var s=p(r);if(u.call(s,e))return s[e](i);var o=l(null,t);return a(s,e,{value:new Function("s","l",n)(i,o)}),o}}var t={value:{writable:!0,value:i}},n="return function(k){if(k===s)return l}",s=l(null),c=function(){var e=Math.random().toString(36).slice(2);return e in s?c():s[e]=e},d=c(),p=function(e){if(u.call(e,d))return e[d];if(!Object.isExtensible(e))throw new TypeError("Object must be extensible");var t=l(null);return a(e,d,{value:t}),t};return r(Object,function(e){var t=o(e);return u.call(e,d)&&t.splice(t.indexOf(d),1),t}),r(e.prototype,function(e){return this.unlock(e).value}),r(e.prototype,function(e,t){this.unlock(e).value=t}),e}(),h=function(s){function o(t){return this===e||null==this||this===o.prototype?new o(t):(f(this,new p),void m(this,t))}function a(e){h(e);var r=g(this).get(e);return r===t?i:r}function c(e,r){h(e),g(this).set(e,r===i?t:r)}function l(e){return h(e),g(this).get(e)!==i}function u(e){h(e);var t=g(this),r=t.get(e)!==i;return t.set(e,i),r}function d(){return g(this),"[object WeakMap]"}var h=function(e){if(null==e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("Invalid WeakMap key")},f=function(e,t){var i=s.unlock(e);if(i.value)throw new TypeError("Object is already a WeakMap");i.value=t},g=function(e){var t=s.unlock(e).value;if(!t)throw new TypeError("WeakMap is not generic");return t},m=function(e,t){null!==t&&"object"==typeof t&&"function"==typeof t.forEach&&t.forEach(function(i,r){i instanceof Array&&2===i.length&&c.call(e,t[r][0],t[r][1])})};try{var v=("return "+u).replace("e_","\\u0065"),w=new Function("unwrap","validate",v)(g,h)}catch(e){var w=u}var v=(""+Object).split("Object"),b=function(){return v[0]+n(this)+v[1]};r(b,b);var y={__proto__:[]}instanceof Array?function(e){e.__proto__=b}:function(e){r(e,b)};return y(o),[d,a,c,l,w].forEach(function(e){r(o.prototype,e),y(e)}),o}(new p),f=Object.create?function(){return Object.create(null)}:function(){return{}};"undefined"!=typeof module?module.exports=h:"undefined"!=typeof exports?exports.WeakMap=h:!("WeakMap"in e)&&(e.WeakMap=h),h.createStorage=s,e.WeakMap&&(e.WeakMap.createStorage=s)}((0,eval)("this"));var codeToClassname=["wi-tornado","wi-day-thunderstorm","wi-hurricane","wi-thunderstorm","wi-storm-showers","wi-rain-mix","wi-rain-mix","wi-rain-mix","wi-rain-mix","wi-snow","wi-rain-mix","wi-showers","wi-showers","wi-snow","wi-snow","wi-rain-mix","wi-snow","wi-rain-mix","wi-hail","wi-fog","wi-fog","wi-fog","wi-fog","wi-fog","wi-cloudy-gusts","wi-cloudy-gusts","wi-cloudy","wi-night-cloudy","wi-day-cloudy","wi-night-partly-cloudy","wi-day-cloudy","wi-night-clear","wi-day-sunny","wi-night-clear","wi-day-sunny","wi-rain-mix","wi-hot","wi-storm-showers","wi-storm-showers","wi-storm-showers","wi-showers","wi-snow","wi-showers","wi-rain-mix","wi-cloudy","wi-storm-showers","wi-hail","wi-storm-showers"];app.bapiModules.templates.makeBooking={init:function(){$(document).on("click",".bapi-revisedates",function(e){$(".modal").modal("hide")})},cond:function(){app.exists(".bapi-bookingform")&&this.init()}},app.bapiModules.templates.propertyDetails={forceusemap:!1,mobileBreak:768,init:function(){this.cond()&&this.openCloseAmenitiesList().lightBoxAndCarousel().checkPropSettings().checkUseMap()},lightBoxAndCarousel:function(){var e=jQuery(".ppt-slides a").simpleLightbox({captionSelector:"self"});return jQuery(document).on("click",".more,.open-lightbox, .ppt-slides a",function(t){if(t.preventDefault(),"undefined"!=typeof jQuery(this).attr("data-index")){var i=jQuery(this).attr("data-index");e.open(jQuery(jQuery('.ppt-slides a[data-index="'+i+'"]')))}else e.open(jQuery(jQuery(".ppt-slides a")[0]))}),window.innerWidth<=768&&this.swiperCarousel(),this},swiperCarousel:function(){return"undefined"!=typeof SWCarousel&&SWCarousel||(SWCarousel=new Swiper(".ppt-images",{spaceBetween:0,nextButton:".next-slide",prevButton:".prev-slide",slidesPerView:1})),this},openCloseAmenitiesList:function(){return jQuery(document).on("click",".template-property .open-close",function(e){jQuery(this).parent().toggleClass("active")}),this},fixHeroImage:function(){if(app.exists(".hero-image")&&!app.isMobile()){var e=jQuery(".hero-image"),t=e.height(),i=e.parent(),r=i.height();if(t>r){var n=Math.round((t-r)/2);e.css("bottom","-"+n+"px")}}return this},checkUseMap:function(){function e(){var e={path:"M-0.5-41C-7.9-41-14-34.9-14-27.5c0,3,1.9,7.9,5.9,15c2.8,5,5.5,9.2,5.6,9.3l2,3l2-3c0.1-0.2,2.9-4.3,5.6-9.3c3.9-7.1,5.9-12,5.9-15C13-34.9,7-41-0.5-41z M-0.5-20.6c-3.9,0-7-3.1-7-7s3.1-7,7-7s7,3.1,7,7S3.4-20.6-0.5-20.6z",fillColor:u,fillOpacity:1,strokeColor:"rgba(0,0,0,.25)",strokeWeight:1};new google.maps.Marker({position:new google.maps.LatLng(n,s),map:l,iw:!1,icon:e})}function t(){var e=new google.maps.StreetViewPanorama(document.getElementById("pano"),{position:{lat:parseFloat(n),lng:parseFloat(s)},pov:{heading:34,pitch:10}});l.setStreetView(e)}function i(){jQuery(c).css("width","50%");var e=l.getCenter();google.maps.event.trigger(l,"resize"),l.setCenter(e),jQuery("#pano").css("width","50%").css("left","50%")}var r=parseInt(jQuery(".bapi-entityadvisor").attr("data-pkid")),n=jQuery(".bapi-entityadvisor").attr("data-lat"),s=jQuery(".bapi-entityadvisor").attr("data-long"),o=selected_usemap,a=!1;o.forEach(function(e){e===r&&(a=!0)}),/comingsoon\.gif/.test(jQuery(".bapi-entityadvisor").attr("data-bg"))&&(a=!0),this.forceusemap&&(a=!0);var c=document.querySelector(".hero-image");if(a){var l=new google.maps.Map(c,{center:{lat:parseFloat(n),lng:parseFloat(s)},scrollwheel:!1,zoom:18}),u=document.querySelector(".template-property[data-markercolor]").dataset.markercolor;switch(selected_usemap_layout){case 0:e(),jQuery(c).css("width","100%"),jQuery("#pano").hide();break;case 1:e(),t(),i();break;case 2:t(),jQuery(c).hide;break;default:e(),t(),i()}}else{var d=jQuery(".bapi-entityadvisor").attr("data-bg");jQuery(c).css("background-image",'url("'+d+'")')}return this},checkThumbs:function(){return/comingsoon\.gif/.test($(".simple-lightbox").attr("href"))?/comingsoon\.gif/.test(jQuery(".bapi-entityadvisor").attr("data-bg"))?($(".ppt-images").hide(),$(".ppt-desc").css("width","100%")):($(".ppt-images").show(),$(".simple-lightbox").attr("href",jQuery(".bapi-entityadvisor").attr("data-bg")),$(".thumb-img").attr("src",jQuery(".bapi-entityadvisor").attr("data-bg"))):($(".ppt-images").show(),1===$(".thumb-img").length&&($(".hero-image").css("background","transparent"),this.forceusemap=!0,$(".more").hide(),$(".ppt-slides li:first-child").css("width","100%"))),this},checkPropSettings:function(){return force_usemap&&(this.forceusemap=!0),forced_featured&&(this.forcedfeatured=!0),usemap_layout>=0&&force_usemap&&(selected_usemap_layout=usemap_layout),this},cond:function(){return app.exists(".page-template-property-detail")}},app.bapiModules.templates.searchPage={defaultView:"",templateSelector:"body.page-template-search-page",mapEle:document.querySelector("#mapContainer"),listInitted:!1,mapInitted:!1,mapPropContainer:document.querySelector("#mapPropertiesContainer"),listPropContainer:document.querySelector("#listPropertiesContainer"),properties:[],totalProps:0,mapObj:null,clustererObj:null,spiderfyObj:null,bounds:null,markers:[],propMarkers:{},openMarkers:[],currentViewMarkers:[],cond:function(){return document.querySelectorAll(this.templateSelector).length>0},init:function(){switch(this.viewToggle(),this.defaultView=BAPI.config().defaultsearchresultview,this.defaultView){case"tmpl-propertysearch-listview":this.doListView();break;case"tmpl-propertysearch-mapview":default:this.doMapView()}this.mapResetEvents()},getProperties:function(e,t){var i=20;this.properties.length?this.properties.forEach(function(t,i){e.call(this,t,i),this.updateCounters()}.bind(this)):app.bapi.search("property",function(r){var n=r.result,s=r.result.length;if(this.totalProps=s,this.updateCounters(),0==s)return void t.call(this,{},0);var o=_.chunk(n,i);o.forEach(function(t,r){BAPI.session.searchparams.pagesize=i,BAPI.session.searchparams.seo=!0,app.bapi.get("property",t,function(t){t.result.forEach(function(t,i){this.properties=_.concat(this.properties,[t]),e.call(this,t,i),this.updateCounters()}.bind(this))}.bind(this),BAPI.session.searchparams)}.bind(this))}.bind(this),BAPI.session.searchparams)},updateCounters:function(){var e=this.properties.length,t=100*e/this.totalProps;$(".map .loader .bar").css("width",t+"%"),$(".ppty-count-current").text(e),$(".ppty-count-total").text(this.totalProps)},initMap:function(e,t){var i=BAPI.config().mapviewType,r=[{featureType:"landscape",stylers:[{hue:"#FFBB00"},{saturation:43.400000000000006},{lightness:37.599999999999994},{gamma:1}]},{featureType:"road.highway",stylers:[{hue:"#FFC200"},{saturation:-61.8},{lightness:45.599999999999994},{gamma:1}]},{featureType:"road.arterial",stylers:[{hue:"#FF0300"},{saturation:-100},{lightness:51.19999999999999},{gamma:1}]},{featureType:"road.local",stylers:[{hue:"#FF0300"},{saturation:-100},{lightness:52},{gamma:1}]},{featureType:"water",stylers:[{hue:"#0078FF"},{saturation:-13.200000000000003},{lightness:2.4000000000000057},{gamma:1}]},{featureType:"poi",stylers:[{hue:"#00FF6A"},{saturation:-1.0989010989011234},{lightness:11.200000000000017},{gamma:1}]}];this.mapObj=new google.maps.Map(this.mapEle,{center:{lat:e,lng:t},zoom:8,styles:r,mapTypeId:google.maps.MapTypeId[i]})},initClusterer:function(){var e=[53,56,66,78,90],t=[{url:"/wp-content/themes/Sites-Theme-Kigo-Discovery/kd-common/img/markers/m1.png",height:e[0],width:e[0]},{url:"/wp-content/themes/Sites-Theme-Kigo-Discovery/kd-common/img/markers/m2.png",height:e[1],width:e[1]},{url:"/wp-content/themes/Sites-Theme-Kigo-Discovery/kd-common/img/markers/m3.png",height:e[2],width:e[2]},{url:"/wp-content/themes/Sites-Theme-Kigo-Discovery/kd-common/img/markers/m4.png",height:e[3],width:e[3]},{url:"/wp-content/themes/Sites-Theme-Kigo-Discovery/kd-common/img/markers/m5.png",height:e[4],width:e[4]}],i={gridSize:50,maxZoom:13,styles:t};this.clustererObj=new MarkerClusterer(this.mapObj,this.markers,i)},initSpiderfy:function(){this.spiderfyObj=new OverlappingMarkerSpiderfier(this.mapObj,{markersWontMove:!0,markersWontHide:!0,keepSpiderfied:!0,legWeight:2})},addMarker:function(e){var t=new google.maps.InfoWindow({content:'<div class="info-html prop-infowindow"><a href="'+e.ContextData.SEO.DetailURL+'" class="image" style="background-image: url('+e.PrimaryImage.ThumbnailURL+')"></a><div class="info"><h5 class="title">'+e.Headline+"</h5>"+e.Location+"</div></div>"}),i=new google.maps.Marker({position:new google.maps.LatLng(e.Latitude,e.Longitude),prop:e,map:this.mapObj,iw:t,icon:{path:"M-0.5-41C-7.9-41-14-34.9-14-27.5c0,3,1.9,7.9,5.9,15c2.8,5,5.5,9.2,5.6,9.3l2,3l2-3c0.1-0.2,2.9-4.3,5.6-9.3c3.9-7.1,5.9-12,5.9-15C13-34.9,7-41-0.5-41z M-0.5-20.6c-3.9,0-7-3.1-7-7s3.1-7,7-7s7,3.1,7,7S3.4-20.6-0.5-20.6z",fillColor:this.mapEle.dataset.color,fillOpacity:1,strokeWeight:0}});i.addListener("click",this.openMarker.bind(this,i)),this.clustererObj.addMarker(i),this.spiderfyObj.addMarker(i),this.spiderfyObj.addListener("click",function(e){this.openMarker(e)}.bind(this)),this.markers.push(i),this.propMarkers[e.AltID]=i},openMarker:function(e){this.openMarkers.map(function(e){e.iw.close()}),this.mapObj.setZoom(15);var t=new google.maps.LatLng({lat:e.getPosition().lat()+.004623495678337974,lng:e.getPosition().lng()});this.mapObj.panTo(t),_.delay(function(){e.iw.open(this.mapObj,e)}.bind(this),150),this.openMarkers.push(e)},addMapProps:function(e){var t=app.bapi.render("tmpl-propertysearch-mapview",{result:e,textdata:BAPI.textdata});this.mapPropContainer.innerHTML=t;var i=this.mapPropContainer.querySelectorAll("[data-altid]");_(i).forEach(function(e){var t=e.querySelector(".viewInMap"),i=e.dataset.altid;t.addEventListener("click",function(){var e=this.propMarkers[i];this.openMarker(e)}.bind(this))}.bind(this))},mapResetEvents:function(){var e=document.querySelectorAll(".resetMap");_.map(e,function(e){e.addEventListener("click",this.centerMap.bind(this))}.bind(this))},centerMap:function(){if(null==this.bounds){var e=new google.maps.LatLngBounds,t=this.markers;for(i in t){var r=t[i];e.extend(new google.maps.LatLng(r.position.lat(),r.position.lng()))}this.bounds=e,this.mapObj.fitBounds(this.bounds)}else this.mapObj.fitBounds(this.bounds)},mapBoundProps:function(){google.maps.event.addListener(this.mapObj,"dragstart",function(){this.mapPropContainer.classList.add("loading")}.bind(this)),google.maps.event.addListener(this.mapObj,"idle",function(){this.mapPropContainer.classList.remove("loading")}.bind(this)),google.maps.event.addListener(this.mapObj,"bounds_changed",_.debounce(function(){this.currentViewMarkers=[],this.markers.forEach(function(e){this.mapObj.getBounds().contains(e.getPosition())&&this.currentViewMarkers.push(e)}.bind(this));var e=[];this.currentViewMarkers.forEach(function(t){e.push(t.prop)}),this.addMapProps(e),$(".ppty-count-current").text(e.length)}.bind(this),250))},doMapView:function(){return document.querySelector(".listView").classList.add("hidden"),document.querySelector(".mapView").classList.remove("hidden"),this.mapInitted?void this.centerMap():void this.getProperties(function(e,t){0==this.markers.length&&(this.initMap(e.Latitude,e.Longitude),this.initClusterer(),this.initSpiderfy(),this.mapBoundProps()),this.addMarker(e),this.markers.length==this.totalProps&&(this.centerMap(),this.mapInitted=!0,_.map(document.querySelectorAll(".viewToggle button"),function(e){e.removeAttribute("disabled")}))},function(){this.addMapProps(this.properties)})},doListView:function(){document.querySelector(".mapView").classList.add("hidden"),document.querySelector(".listView").classList.remove("hidden"),this.listInitted||(this.getProperties(function(e,t){e.Summary=e.Summary.length<=200?e.Summary:e.Summary.replace(/(<([^>]+)>)/gi,"").substr(0,200)+'... <a href="'+e.ContextData.SEO.DetailURL+'">['+BAPI.textdata.more+"]</a>";var i=app.bapi.render("tmpl-propertysearch-listview",{result:[e],textdata:BAPI.textdata});this.listPropContainer.innerHTML+=i,this.properties.length==this.totalProps&&_.map(document.querySelectorAll(".viewToggle button"),function(e){e.removeAttribute("disabled")})},function(){var e=app.bapi.render("tmpl-propertysearch-listview",{result:[],textdata:BAPI.textdata});this.listPropContainer.innerHTML+=e}),this.listInitted=!0)},viewToggle:function(){var e=document.querySelector(".viewToggle .v-list"),t=document.querySelector(".viewToggle .v-map");BAPI.config().defaultsearchresultview?BAPI.config().searchmodes.listview&&!BAPI.config().searchmodes.mapview?t.parentNode.removeChild(t):!BAPI.config().searchmodes.listview&&BAPI.config().searchmodes.mapview?e.parentNode.removeChild(e):(document.querySelector(".viewToggle .v-map").addEventListener("click",this.doMapView.bind(this)),document.querySelector(".viewToggle .v-list").addEventListener("click",this.doListView.bind(this))):(e.parentNode.removeChild(e),t.parentNode.removeChild(t))}},app.bapiModules.widgets.buckets={selector:".kd-buckets",init:function(){$(this.selector).each(function(e,t){app.bapi.recursiveGet("searches",function(e){var i=Object.assign(e,{class:t.dataset.class});t.innerHTML=app.bapi.render("tmpl-searches-quickview",i)})})},cond:function(){return app.exists(this.selector)}},app.modules.widgets.featured={selector:".kd-featured",sliderSelector:".swiper-container",observedSelector:".swiper-wrapper",init:function(){var e=document.querySelectorAll(this.selector);$.each(e,function(e,t){var i=t.querySelector(this.observedSelector);if(i.children.length>0)this.initSlider(e,t);else{var r=new MutationObserver(function(i){this.initSlider(e,t),r.disconnect()}.bind(this));r.observe(i,{childList:!0})}}.bind(this))},cond:function(){return app.exists(this.selector)},getSliderConfig:function(e){return{autoplay:!1,loop:!0,paginationClickable:!0,pagination:e.querySelector(".swiper-pagination"),nextButton:e.querySelector(".next"),prevButton:e.querySelector(".prev"),bulletActiveClass:"secondary-fill-color",simulateTouch:!1}},initSlider:function(e,t){var i=t.querySelector(this.sliderSelector);app.initSwiper(i,this.getSliderConfig(t))}},app.modules.widgets.hero={selector:".kd-hero",sliderSelector:".swiper-container",init:function(){var e=document.querySelectorAll(this.selector);$.each(e,this.initSlider.bind(this))},cond:function(){return app.exists(this.selector)},getSliderConfig:function(e){var t=e.querySelector(this.sliderSelector).dataset,i={autoplay:t.speed||!1,loop:"on"==t.loop,nextButton:e.querySelector(".next"),prevButton:e.querySelector(".prev"),effect:t.effect||"slide",speed:500,freeMode:"on"==t.freemode,direction:t.direction||"horizontal",pagination:"on"==t.pagination&&e.querySelector(".swiper-pagination"),paginationClickable:!0,bulletActiveClass:"active",centeredSlides:"on"==t.centered_slides,slidesPerView:t.slides_per_view||1};return i},initSlider:function(e,t){var i=this.getSliderConfig(t);app.initSwiper(t.querySelector(this.sliderSelector),i)}},app.modules.widgets.items={selector:".kd-items",init:function(){this.toggleEvents(),this.initSliders()},toggleEvents:function(){var e=document.querySelectorAll(".item-block .open-close");$.each(e,function(e,t){t.addEventListener("click",function(e){this.parentElement.classList.toggle("active")})})},initSliders:function(){for(var e=document.querySelectorAll(this.selector+" .swiper-container"),t=0;t<e.length;t++){var i=e[t];new Swiper(i,{spaceBetween:15,nextButton:".next-slide",prevButton:".prev-slide",slidesPerView:i.dataset.columns||5,loop:!0,loopAdditionalSlides:5,breakpoints:{992:{slidesPerView:3},780:{centeredSlides:!0,slidesPerView:2},480:{centeredSlides:!0,slidesPerView:1}}})}},cond:function(){return app.exists(".kd-items")}},app.modules.widgets.map={selector:".kd-map .map-canvas",init:function(){geocoder=new google.maps.Geocoder,$(this.selector).each(function(e,t){geocoder&&geocoder.geocode({address:t.dataset.location},function(e,i){var r=e[0].geometry.location,n=new google.maps.Map(t,{center:r,zoom:1*t.dataset.zoom||10});new google.maps.Marker({map:n,position:r})})})},cond:function(){return app.exists(this.selector)}},app.modules.widgets.menu={selector:".kd-menu",init:function(){for(var e=document.querySelectorAll(this.selector),t=0;t<e.length;t++)this.bindEvents(e.item(t))},cond:function(){return app.exists(this.selector)},bindEvents:function(e){var t=e.querySelector(".toggle");t.addEventListener("click",this.toggleMenu.bind(e))},toggleMenu:function(){this.classList.toggle("active")}},app.bapiModules.widgets.search={selector:".kd-search",init:function(){$(this.selector).each(function(e,t){t.querySelector(".search-button-block .more").addEventListener("click",function(e){t.classList.toggle("open"),this.classList.toggle("active")})})},cond:function(){return app.exists(this.selector)}},app.bapiModules.widgets.selective_search={selector:".kd-selective-search-box",init:function(){$(".kd-selective-search-box .toggle-filter").on("click",function(e){e.preventDefault(),$(this).toggleClass("active");var t=$($(this).attr("data-types")),i=$(this).parent().parent().find(".toggle-filter"),r=$(this).prev();r.prop("checked",!r.prop("checked"));var n=[];$.each(i,function(e,t){$(this).hasClass("active")&&n.push($(this).attr("data-toggle"))}),t.get(0).value=n.join(",")}),$(".filter-by").on("click",function(e){e.preventDefault(),$(this).toggleClass("active"),$(this).parent().on("click",function(e){e.stopPropagation()}),$(this).parent().next().toggleClass("active")}),$(".clearsearch").on("click",function(e){e.preventDefault(),$(".kd-selective-search-box .toggle-filter").removeClass("active");var t=$($(this).attr("data-types")),i=$(this).parent().parent().find(".ptype input");i.prop("checked",!1),t.get(0).value=""}),$(window).on("click",function(e){$(".currently-filtering").removeClass("active"),$(".filter-by").removeClass("active")}),$(".currently-filtering").on("click",function(e){e.stopPropagation()})},cond:function(){return app.exists(this.selector)}},app.bapiModules.widgets.specials={selector:".kd-specials",init:function(){$(this.selector).each(function(e,t){app.bapiRender("specials","tmpl-specials-quickview",function(e){t.innerHTML=e},{class:t.dataset.class})})},cond:function(){return app.exists(this.selector)}},app.modules.widgets.team={mobileBreak:991,selector:".kd-team",init:function(){for(var e=document.querySelectorAll(this.selector+".swiper-container"),t=0;t<e.length;t++){var i=e[t];new Swiper(i,{nextButton:".next-slide",prevButton:".prev-slide",slidesPerView:i.dataset.columns||5,loop:!0,loopAdditionalSlides:5,simulateTouch:!1,breakpoints:{992:{slidesPerView:3},780:{centeredSlides:!0,slidesPerView:2},480:{centeredSlides:!0,slidesPerView:1}},onInit:function(){i.classList.remove("faded-out")}})}},cond:function(){return app.exists(".kd-team")}};