$(function(){$("ol.sortable").sortable({group:"sortable-group",placeholder:'<li class="placeholder">Drop Here</li>',isValidTarget:function(b,a){var c=$(a.el[0]);if(c.is(".ma-list-parent,.prop-list-parent, .to-save, .to-save > li > ol, .to-save > li > ol > li > ol,.to-save > li > ol > li > ol > li > ol, .to-save > li > ol > li > ol > li > ol > li > ol")){if(c.hasClass("ma-list-parent")&&b.hasClass("ma-item")){if(b.find(".prop-item").length){return false}return true}if(c.hasClass("prop-list-parent")&&b.hasClass("prop-item")){return true}if(c.is(".to-save, .to-save > li > ol, .to-save > li > ol > li > ol,.to-save > li > ol > li > ol > li > ol")&&b.is(".ma-item,.prop-item")){return true}if(c.is(".to-save > li > ol > li > ol,.to-save > li > ol > li > ol > li > ol, .to-save > li > ol > li > ol > li > ol > li > ol")&&b.is(".prop-item")){return true}}return false},onDrop:function(b,a,d,c){b.removeClass(a.group.options.draggedClass).removeAttr("style");$("body").removeClass(a.group.options.bodyClass);var e=$(a.el[0]);if(e.is(".to-save, .to-save > li > ol, .to-save > li > ol")&&b.is(".ma-item,.prop-item")){b.addClass("active");if(b.is(".ma-item")&&tree_watched){$(".subarea-config").remove();add_subarea_form_fill_buttons()}}else{b.removeClass("active");b.find(".subarea-config").remove()}enable_quicksearches();update_ma_json();check_saved_settings()}});$(document).on("dblclick",".market-areas-tree.to-save .button-marketarea",function(a){a.preventDefault();remove_all_edit_name();$(this).attr("data-old-name",$(this).text());$(this).html('<input type="text" class="edit-name" placeholder="'+$(this).attr("data-name")+'" value="'+$(this).attr("data-name")+'"/>').find(".edit-name").focus().select()}).on("keydown",".market-areas-tree.to-save .button-marketarea .edit-name",function(a){if(a.which==13){a.preventDefault();a.stopPropagation();if($(this).val()!==""){var b=$(this).val().trim().replace(/\s\s+/g," ");update_setting_name($(this).parent().attr("data-old-name"),b);$(this).parent().attr("data-name",b);$(this).parent().parent().attr("data-name",b);$(this).parent().html(b);update_ma_json();tree_remove_alerts();$(".subarea-config").remove();add_subarea_form_fill_buttons();check_saved_settings()}}if(a.which==27){$(this).parent().html($(this).parent().attr("data-name"))}}).on("click",function(a){remove_all_edit_name()});$("#search-locations, #search-properties").on("click",function(a){$(this).focus().select()});$(document).on("click",".button-marketarea",function(a){a.preventDefault();a.stopPropagation();remove_all_edit_name();if($(this).is(".to-save a")){remove_active_container();$(this).parent().find(">ol").addClass("active-container");$(this).addClass("active-container")}var b=$(this).attr("data-original-name").split("::")[0].trim();$("#search-properties").val(b).keyup()});$(".market-areas-tree").click(function(a){remove_active_container()});$(".add-selected").on("click",function(b){$(".select-visible").attr("checked",false);var a=$('.prop-list-parent li input[type="checkbox"]:checked');if($("ol.active-container").length){$.each(a,function(d,c){$(this).parent().appendTo("ol.active-container");$(this).attr("checked",false)})}else{$.each(a,function(d,c){$(this).parent().appendTo("ol.to-save");$(this).attr("checked",false)})}update_ma_json()});$(".generate-landings").on("click",function(b){var a=$(this).attr("checked")?true:false;switch(a){case true:tree_watched=true;$(".subarea-config").remove();add_subarea_form_fill_buttons();check_saved_settings();watch_tree();break;default:$(".subarea-config").remove();tree_watched=false}$("input#market_area_generate_landing").attr("checked",a)});$('[data-toggle="tooltip"]').tooltip();$(".generate-landings-label").hover(null,function(){$(this).find("input").blur()});enable_quicksearches();$(".button-property").on("click",function(a){$(this).prev().click()});$(".select-visible").on("change",function(b){var a=$(this).attr("checked")?true:false;$('.prop-list-parent li:visible input[type="checkbox"]').attr("checked",a)});$(".search-locations-select").on("change",function(a){if($(this).val()!==""){$(".ma-list-parent .ma-item").hide();$('.ma-list-parent [data-type="'+$(this).val()+'"]').show()}else{$(".ma-list-parent .ma-item").show()}});$('[name="save"]').on("click",function(a){a.preventDefault();if(tree_validate()){$("#post").submit()}else{modal_error_repeated_names()}});$(document).on("click",".subarea-config",function(a){if(!tree_validate()){modal_error_repeated_names()}else{modal_form($(this).attr("data-subarea"))}});$(".clear-areas").on("click",clear_areas);$(".reset-areas").on("click",reset_areas);reset_areas()});